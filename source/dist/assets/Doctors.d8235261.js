var $=Object.defineProperty;var z=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var V=(e,u,s)=>u in e?$(e,u,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[u]=s,S=(e,u)=>{for(var s in u||(u={}))W.call(u,s)&&V(e,s,u[s]);if(z)for(var s of z(u))M.call(u,s)&&V(e,s,u[s]);return e};var a=(e,u,s)=>(V(e,typeof u!="symbol"?u+"":u,s),s);import{_ as j,r as m,k as h,l as t,n,F as C,J as U,f as P,m as v,t as g,u as _,I as k,w as y,V as Y,O as R,E as J,L as K,T as q,M as G,R as H,D as Q,K as X,i as Z,o as d,p as x,s as ee}from"./vendor.825dd2c3.js";import{b as ue,p as oe,s as te,d as se,U as ae}from"./index.16741bc9.js";import{d as ne,e as le,f as ie,h as re,a as de}from"./index.056d9d85.js";import{f as ce}from"./forrmaters.4a830e90.js";import{N as f}from"./notify.a97b9367.js";import{P as he}from"./preloader.bffd7f9b.js";var pe="/img/my-patients-search.png";var me=Object.defineProperty,_e=Object.getOwnPropertyDescriptor,ve=(e,u,s,l)=>{for(var c=l>1?void 0:l?_e(u,s):u,p=e.length-1,i;p>=0;p--)(i=e[p])&&(c=(l?i(u,s,c):i(c))||c);return l&&c&&me(u,s,c),c};let fe=[];const w=[{value:0,name:"\u042F\u043D\u0432\u0430\u0440\u044C"},{value:1,name:"\u0424\u0435\u0432\u0440\u0430\u043B\u044C"},{value:2,name:"\u041C\u0430\u0440\u0442"},{value:3,name:"\u0410\u043F\u0440\u0435\u043B\u044C"},{value:4,name:"\u041C\u0430\u0439"},{value:5,name:"\u0418\u044E\u043D\u044C"},{value:6,name:"\u0418\u044E\u043B\u044C"},{value:7,name:"\u0410\u0432\u0433\u0443\u0441\u0442"},{value:8,name:"\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C"},{value:9,name:"\u041E\u043A\u0442\u044F\u0431\u0440\u044C"},{value:10,name:"\u041D\u043E\u044F\u0431\u0440\u044C"},{value:11,name:"\u0414\u0435\u043A\u0430\u0431\u0440\u044C"}];let B=class extends Y{constructor(){super(...arguments);a(this,"doctorsLoading",!1);a(this,"profileLoading",!1);a(this,"searchText","");a(this,"doctorsList",[]);a(this,"chosenDoctor",null);a(this,"login");a(this,"isSignature",!1);a(this,"phoneNumber");a(this,"showDeletePopup",!1);a(this,"isLoadingPhoto",!1);a(this,"currentTab","education");a(this,"institution","");a(this,"course","");a(this,"organization",null);a(this,"organizations",[]);a(this,"employeePersonnelNumber",null);a(this,"isDoctorSaving",!1);a(this,"experiences",[]);a(this,"months",w);a(this,"test","");a(this,"test1","")}get years(){const e=new Date().getUTCFullYear();return Array(e-(e-50)).fill("").map((u,s)=>String(e-s))}get avatarId(){return this.chosenDoctor&&this.chosenDoctor.avatarId}setCurrentWork(){console.log(1)}isShowCurrentWork(e){return!1}async getAccount(){if(!this.chosenDoctor)return;this.profileLoading=!0,this.institution=this.chosenDoctor.institution||null,this.course=this.chosenDoctor.course||null;const e=this.organizations.find(u=>{var s;return u.inn===((s=this.chosenDoctor)==null?void 0:s.organizationInn)});this.organization=e||null,this.employeePersonnelNumber=this.chosenDoctor.employeePersonnelNumber||null;try{const u=await ue(this.chosenDoctor.doctorId);this.login=u.login,this.phoneNumber=u.phoneNumber,this.isSignature=!!u.hasSignature;const s=await ne(this.chosenDoctor.doctorId);this.experiences=s.experiences.map(l=>{const c=new Date(l.dateStart),p=l.dateEnd?new Date(l.dateEnd):null,i=w.find(b=>b.value===c.getMonth()),E=p?w.find(b=>b.value===p.getMonth()):null;return S({isDelete:!1,isNew:!1,monthStart:i,yearStart:c.getFullYear(),monthEnd:E,yearEnd:p?p.getFullYear():null,currentWork:!1},l)}),console.log(this.experiences)}catch{f.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0434\u0430\u043D\u043D\u044B\u0445 \u0434\u043E\u043A\u0442\u043E\u0440\u0430")}finally{this.profileLoading=!1}}async selectDoctor(e){this.chosenDoctor=e,this.currentTab="education",await this.getAccount()}isChosen(e){return this.chosenDoctor&&e.doctorId===this.chosenDoctor.doctorId}fio(e){return ce(e)}formatSpeciality(e){var u,s;return((u=e.specialities)==null?void 0:u.length)&&((s=e.specialities[0])==null?void 0:s.specialityName)||"-"}async saveEducation(e){await le(e,{institution:this.institution,course:this.course})}async saveOrganization(e){var u;await ie(e,{employeePersonnelNumber:this.employeePersonnelNumber,organizationInn:(u=this.organization)==null?void 0:u.inn})}async saveDoctor(e){if(!e)return;const u=e.doctorId;this.isDoctorSaving=!0;try{await this.saveEducation(u),await this.saveOrganization(u),f.success("\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0430")}catch{f.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0434\u043E\u043A\u0442\u043E\u0440\u0430")}finally{this.isDoctorSaving=!1}}async uploadAvatar(e){if(!e)return;const u=e.doctorId,s=this.$refs.inputAvatar.files[0];this.isLoadingPhoto=!0;try{await this.deleteAvatar(e);const l=new FormData;l.append("file",s,s.name),l.append("ReadAccessMode","Public"),l.append("WriteFileAccessMode","ApplicationOperators"),this.$refs.inputAvatar.value="";const c=await oe(l),{avatarId:p}=await te(c.fileId,u);await this.updateAvatarUrl(u,p)}catch{f.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0444\u043E\u0442\u043E")}finally{this.isLoadingPhoto=!1}}updateAvatarUrl(e,u=null){let s=this.doctorsList.find(l=>l.doctorId===e);s&&(s.avatarId=u)}async deleteAvatar(e){if(!e)return;const u=e.doctorId;if(!!this.avatarId){this.isLoadingPhoto=!1,this.showDeletePopup=!1;try{await se(u),this.updateAvatarUrl(u)}catch{f.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0444\u043E\u0442\u043E")}}}async fetchOrganizations(){this.organizations=await re()}async fetchDoctors(){this.doctorsLoading=!0;try{this.doctorsList=fe=await de()}catch{f.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0441\u043F\u0438\u0441\u043A\u0430 \u0434\u043E\u043A\u0442\u043E\u0440\u043E\u0432")}finally{this.doctorsLoading=!1}}async mounted(){await this.fetchOrganizations(),await this.fetchDoctors()}};B=ve([R({components:{BInput:J,BCheckbox:K,BCancellable:q,BTabs:G,BTab:H,BBtn:Q,BSelect:X,BIcon:Z,UserAvatar:ae,Preloader:he}})],B);const be=B,A=e=>(x("data-v-326e58db"),e=e(),ee(),e),De={class:"doctors"},ge={class:"doctors__left"},Ee={class:"doctors-list"},ye={key:0},Ve=["onClick"],Ce={class:"doctors-list-item__col"},we={class:"doctors-list-item__col b-text-m"},Be={class:"doctors-list-item__name"},Ae={class:"doctors-list-item__desc"},Ie={key:1,class:"doctors-list__empty"},Fe=_(" \u0412\u0440\u0430\u0447 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D "),ze={class:"doctors__right"},Se={key:0,class:"doctors__right-empty"},Ue=A(()=>t("div",null,[t("img",{src:pe,class:"doctors__right-emptyImage"}),t("div",{class:"b-h4"},[_(" \u0427\u0442\u043E\u0431\u044B \u043D\u0430\u0439\u0442\u0438 \u0432\u0440\u0430\u0447\u0430, \u0432\u043E\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435\u0441\u044C"),t("br"),_(" \u043F\u043E\u0438\u0441\u043A\u043E\u043C \u0438\u043B\u0438 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430 ")])],-1)),Pe=[Ue],ke={key:1,class:"doctors__rightContent"},Le={class:"chosen-doctor"},Ne={class:"chosen-doctor__col"},Te={class:"chosen-doctor__col b-text-m"},Oe={class:"chosen-doctor__name b-h4"},$e={class:"chosen-doctor__desc b-text-m"},We={class:"chosen-doctor__photoBtn"},Me=["disabled"],je={class:"chosen-doctor-filter"},Ye={class:"chosen-doctor-filter__col"},Re={class:"chosen-doctor-filter__input"},Je={class:"chosen-doctor-filter__input"},Ke={class:"chosen-doctor-filter__col"},qe={class:"chosen-doctor-filter__input"},Ge={class:"chosen-doctor-filter__input"},He={class:"chosen-doctor-filter__checkbox"},Qe=_("\u042D\u0426\u041F"),Xe={key:0},Ze={key:1},xe={class:"experiences-wrap"},eu={class:"experiences-row"},uu={class:"experiences__wrap"},ou={class:"experiences__row experiences__place"},tu={class:"experiences__remove"},su={class:"experiences__row"},au=A(()=>t("div",{class:"b-caption-s experiences__title"}," \u041D\u0430\u0447\u0430\u043B\u043E \u0440\u0430\u0431\u043E\u0442\u044B ",-1)),nu={class:"experiences__select"},lu={class:"experiences__now"},iu=_(" \u0420\u0430\u0431\u043E\u0442\u0430\u044E \u0437\u0434\u0435\u0441\u044C \u0432 \u043D\u0430\u0441\u0442\u043E\u044F\u0449\u0438\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 "),ru={class:"experiences__row"},du=A(()=>t("div",{class:"b-caption-s experiences__title"}," \u041E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u0435 \u0440\u0430\u0431\u043E\u0442\u044B ",-1)),cu={class:"experiences__select"},hu=_(" \u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C ");function pu(e,u,s,l,c,p){const i=m("b-input"),E=m("user-avatar"),b=m("preloader"),L=m("b-cancellable"),D=m("b-select"),I=m("b-checkbox"),F=m("b-tab"),N=m("b-tabs"),T=m("b-icon"),O=m("b-btn");return d(),h("div",De,[t("div",ge,[n(i,{modelValue:e.searchText,"onUpdate:modelValue":u[0]||(u[0]=o=>e.searchText=o),canceled:"",autofocus:"",size:"m",icon:"search",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F \u0432\u0440\u0430\u0447\u0430"},null,8,["modelValue"]),t("div",Ee,[e.doctorsList.length?(d(),h("div",ye,[(d(!0),h(C,null,U(e.doctorsList,(o,r)=>(d(),h("div",{key:r,class:k([e.isChosen(o)&&"doctors-list-item--active","doctors-list-item"]),onClick:mu=>e.selectDoctor(o)},[t("div",Ce,[n(E,{"avatar-id":o.avatarId},null,8,["avatar-id"])]),t("div",we,[t("div",Be,g(e.fio(o)),1),t("div",Ae,g(e.formatSpeciality(o)),1)])],10,Ve))),128))])):(d(),h("div",Ie,[e.doctorsLoading?(d(),P(b,{key:0})):v("",!0),e.doctorsLoading?v("",!0):(d(),h(C,{key:1},[Fe],64))]))])]),t("div",ze,[e.chosenDoctor?v("",!0):(d(),h("div",Se,Pe)),!e.profileLoading&&e.chosenDoctor?(d(),h("div",ke,[t("div",Le,[t("div",Ne,[n(E,{size:"xxl","avatar-id":e.chosenDoctor.avatarId},null,8,["avatar-id"])]),t("div",Te,[t("div",Oe,g(e.fio(e.chosenDoctor)),1),t("div",$e,[_(g(e.formatSpeciality(e.chosenDoctor))+" ",1),t("div",We,[t("label",{class:k([e.isLoadingPhoto&&"chosen-doctor__avatarActionDisabled","b-text-link"]),for:"avatarInput"},[_(g(e.chosenDoctor.avatarId?"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0444\u043E\u0442\u043E":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0444\u043E\u0442\u043E")+" ",1),t("input",{id:"avatarInput",ref:"inputAvatar",class:"chosen-doctor__avatarInput",accept:"image/jpeg,image/png",type:"file",disabled:e.isLoadingPhoto,onInput:u[1]||(u[1]=o=>e.uploadAvatar(e.chosenDoctor))},null,40,Me)],2),t("a",{class:"b-text-link",onClick:u[2]||(u[2]=o=>e.showDeletePopup=!0)}," \u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0444\u043E\u0442\u043E "),n(L,{modelValue:e.showDeletePopup,"onUpdate:modelValue":u[3]||(u[3]=o=>e.showDeletePopup=o),message:"\u0424\u043E\u0442\u043E\u0433\u0440\u0430\u0444\u0438\u044F \u0443\u0434\u0430\u043B\u0435\u043D\u0430","button-label":"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C","cancel-message":"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u043E",timeout:5e3,onTimerEnd:u[4]||(u[4]=o=>e.deleteAvatar(e.chosenDoctor))},null,8,["modelValue"])])])])]),t("div",je,[t("div",Ye,[t("div",Re,[n(i,{modelValue:e.phoneNumber,"onUpdate:modelValue":u[5]||(u[5]=o=>e.phoneNumber=o),placeholder:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D","float-label":"",disabled:""},null,8,["modelValue"])]),t("div",Je,[n(D,{modelValue:e.organization,"onUpdate:modelValue":u[6]||(u[6]=o=>e.organization=o),placeholder:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F","button-size":"m","option-label":"name","no-reset":"",options:e.organizations},null,8,["modelValue","options"])])]),t("div",Ke,[t("div",qe,[n(i,{modelValue:e.login,"onUpdate:modelValue":u[7]||(u[7]=o=>e.login=o),placeholder:"\u041B\u043E\u0433\u0438\u043D","float-label":"",disabled:""},null,8,["modelValue"])]),t("div",Ge,[n(i,{modelValue:e.employeePersonnelNumber,"onUpdate:modelValue":u[8]||(u[8]=o=>e.employeePersonnelNumber=o),placeholder:"\u0422\u0430\u0431\u0435\u043B\u044C\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440","float-label":""},null,8,["modelValue"])])])]),t("div",He,[n(I,null,{default:y(()=>[Qe]),_:1})]),t("div",null,[n(N,{modelValue:e.currentTab,"onUpdate:modelValue":u[9]||(u[9]=o=>e.currentTab=o)},{default:y(()=>[n(F,{label:"\u041E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u043D\u0438\u0435",name:"education"}),n(F,{label:"\u041E\u043F\u044B\u0442 \u0440\u0430\u0431\u043E\u0442\u044B",name:"experience"})]),_:1},8,["modelValue"]),e.currentTab==="education"?(d(),h("div",Xe,[n(i,{modelValue:e.institution,"onUpdate:modelValue":u[10]||(u[10]=o=>e.institution=o),class:"chosen-doctor__textarea",type:"textarea",size:"m","float-label":"",placeholder:"\u041E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u043D\u0438\u0435",canceled:"",max:4e3},null,8,["modelValue"]),n(i,{modelValue:e.course,"onUpdate:modelValue":u[11]||(u[11]=o=>e.course=o),class:"chosen-doctor__textarea",type:"textarea",size:"m","float-label":"",canceled:"",placeholder:"\u041A\u0443\u0440\u0441\u044B \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u044F \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438",max:4e3},null,8,["modelValue"])])):v("",!0),e.currentTab==="experience"?(d(),h("div",Ze,[t("div",xe,[t("div",eu,[(d(!0),h(C,null,U(e.experiences,o=>(d(),h("div",{key:o.experienceId,class:"experiences"},[t("div",uu,[t("div",ou,[n(i,{modelValue:o.organization,"onUpdate:modelValue":r=>o.organization=r,size:"m","float-label":"",canceled:"",placeholder:"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B"},null,8,["modelValue","onUpdate:modelValue"]),t("div",tu,[n(T,{name:"trash",color:"$b-secondary-label"})])]),n(i,{modelValue:o.position,"onUpdate:modelValue":r=>o.position=r,class:"experiences__row",size:"m","float-label":"",canceled:"",placeholder:"\u0414\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u044C"},null,8,["modelValue","onUpdate:modelValue"]),t("div",su,[au,t("div",nu,[n(D,{modelValue:o.monthStart,"onUpdate:modelValue":r=>o.monthStart=r,options:e.months,placeholder:"\u041C\u0435\u0441\u044F\u0446","button-size":"m","option-label":"name"},null,8,["modelValue","onUpdate:modelValue","options"]),n(D,{modelValue:o.yearStart,"onUpdate:modelValue":r=>o.yearStart=r,options:e.years,placeholder:"\u0413\u043E\u0434"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",lu,[e.isShowCurrentWork(o)?(d(),P(I,{key:0,onInput:u[12]||(u[12]=r=>e.setCurrentWork())},{default:y(()=>[iu]),_:1})):v("",!0)])]),t("div",ru,[du,t("div",cu,[n(D,{modelValue:o.monthEnd,"onUpdate:modelValue":r=>o.monthEnd=r,options:e.months,placeholder:"\u041C\u0435\u0441\u044F\u0446","button-size":"m","option-label":"name"},null,8,["modelValue","onUpdate:modelValue","options"]),n(D,{modelValue:o.yearEnd,"onUpdate:modelValue":r=>o.yearEnd=r,options:e.years,placeholder:"\u0413\u043E\u0434"},null,8,["modelValue","onUpdate:modelValue","options"])])])])]))),128))])])])):v("",!0),n(O,{class:"chosen-doctor__save",size:"m",loading:e.isDoctorSaving,onClick:u[13]||(u[13]=o=>e.saveDoctor(e.chosenDoctor))},{default:y(()=>[hu]),_:1},8,["loading"])])])):v("",!0)])])}var yu=j(be,[["render",pu],["__scopeId","data-v-326e58db"]]);export{yu as default};
